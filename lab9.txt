Zad 1. 
Select FIRST_NAME, LAST_NAME, pensja, RANK() OVER (ORDER BY pensja DESC) AS salary_rank FROM EMPLOYEE;

Zad 2.
SELECT FIRST_NAME, LAST_NAME, pensja, SUM(pensja) OVER () AS total_salary_all FROM EMPLOYEE;

Zad 3.
SELECT E.LAST_NAME, P.PRODUCT_NAME, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER (PARTITION BY O.EMPLOYEE_ID) AS employee_total_sales, RANK() OVER (ORDER BY OP.AMOUNT * OP.SELL_PRICE DESC) AS sales_rank FROM ORDER_POSITION OP JOIN `ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN EMPLOYEE E ON O.EMPLOYEE_ID = E.EMPLOYEE_NAME JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;

Zad 4.
SELECT E.LAST_NAME, P.PRODUCT_NAME, OP.SELL_PRICE, COUNT(*) OVER (PARTITION BY P.PRODUCT_ID, O.ORDER_DATE) AS transactions_per_day, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER ( PARTITION BY P.PRODUCT_ID, O.ORDER_DATE) AS daily_sum, LAG(OP.SELL_PRICE) OVER (PARTITION BY P.PRODUCT_ID ORDER BY O.ORDER_DATE) AS next_price FROM ORDER_POSITION OP JOIN `ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN EMPLOYEE E ON O.EMPLOYEE_ID = E.EMPLOYEE_NAME JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;

Zad 5. 
SELECT P.PRODUCT_NAME, OP.SELL_PRICE, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER (PARTITION BY MONTH(O.ORDER_DATE)) AS monthly_sum, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER (PARTITION BY MONTH(O.ORDER_DATE) ORDER BY O.ORDER_DATE) AS running_monthly_sum FROM ORDER_POSITION OP JOIN `ORDER O ON OP.ORDER_ID = O.ORDER_ID JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;

Zad 6.
SELECT C.CATEGORY_NAME, SUM(CASE WHEN MONTH(O.ORDER_DATE)=1 THEN OP.AMOUNT*OP.SELL_PRICE ELSE 0 END) AS jan_sum, SUM(CASE WHEN MONTH(O.ORDER_DATE)=2 THEN OP.AMOUNT*OP.SELL_PRICE ELSE 0 END) AS feb_sum, SUM(CASE WHEN MONTH(O.ORDER_DATE)=3 THEN OP.AMOUNT*OP.SELL_PRICE ELSE 0 END) AS mar_sum, SUM(CASE WHEN MONTH(O.ORDER_DATE)=4 THEN OP.AMOUNT*OP.SELL_PRICE ELSE 0 END) AS apr_sum, ABS( SUM(CASE WHEN MONTH(O.ORDER_DATE)=4 THEN OP.AMOUNT*OP.SELL_PRICE ELSE 0 END) - SUM(CASE WHEN MONTH(O.ORDER_DATE)=1 THEN OP.AMOUNT*OP.SELL_PRICE ELSE 0 END) ) AS diff_apr_jan FROM ORDER_POSITION OP JOIN `ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID JOIN CATEGORY C ON P.CATEGORY_ID = C.CATEGORY_ID WHERE YEAR(O.ORDER_DATE) = 2025 GROUP BY C.CATEGORY_ID, C.CATEGORY_NAME;

Zad 7.
SELECT C.CATEGORY_NAME, P.PRODUCT_NAME, OP.SELL_PRICE, MIN(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) AS min_price, MAX(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) AS max_price, MAX(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) - MIN(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) AS price_diff FROM ORDER_POSITION OP JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID JOIN CATEGORY C ON P.CATEGORY_ID = C.CATEGORY_ID;

Zad 8.
SELECT P.PRODUCT_NAME, OP.SELL_PRICE, AVG(OP.SELL_PRICE) OVER ( PARTITION BY P.PRODUCT_ID ORDER BY O.ORDER_DATE ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING ) AS moving_avg_price FROM ORDER_POSITION OP JOIN `ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;

Zad 9.
SELECT P.PRODUCT_NAME, C.CATEGORY_NAME, OP.SELL_PRICE, RANK() OVER ( PARTITION BY P.CATEGORY_ID ORDER BY OP.SELL_PRICE ) AS price_rank, ROW_NUMBER() OVER ( PARTITION BY P.CATEGORY_ID ORDER BY OP.SELL_PRICE ) AS row_num, DENSE_RANK() OVER ( PARTITION BY P.CATEGORY_ID ORDER BY OP.SELL_PRICE ) AS dense_price_rank FROM ORDER_POSITION OP JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID JOIN CATEGORY C ON P.CATEGORY_ID = C.CATEGORY_ID;

Zad 10.
SELECT E.LAST_NAME, P.PRODUCT_NAME, OP.AMOUNT * OP.SELL_PRICE AS position_value, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER ( PARTITION BY O.EMPLOYEE_ID ORDER BY O.ORDER_DATE ) AS running_employee_sales, RANK() OVER ( PARTITION BY O.EMPLOYEE_ID ORDER BY OP.AMOUNT * OP.SELL_PRICE DESC ) AS position_rank FROM ORDER_POSITION OP JOIN `ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN EMPLOYEE E ON O.EMPLOYEE_ID = E.EMPLOYEE_NAME JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;

Zad 11.
SELECT DISTINCT E.FIRST_NAME, E.LAST_NAME, JP.POSITION_NAME FROM EMPLOYEE E JOIN `ORDER` O ON O.EMPLOYEE_ID = E.EMPLOYEE_NAME JOIN JOB_POSITION JP ON E.JOB_POSITION_ID = JP.JOB_POSITION_ID;

